<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>TODO</title>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body>
        <div id="container-tasks-buttons">
            <div id="container-top-buttons" style="display: flex; flex-direction: row;justify-content: space-between;padding: 0 0.5em; align-items: center;">
                <div>
                    <button id="add-task-btn" style="all:unset" class="add-task-btn-wide-view">
                        <svg xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem" fill="#878787" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
                          </svg>
                    </button>
                </div>
                <div>
                    <div class="dropdown-icon-orderby">
                        <button class="dropbtn-icon-orderby" style="all:unset">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1.4rem" height="1.4rem" fill="#878787" class="bi bi-funnel" viewBox="0 0 16 16">
                                <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2zm1 .5v1.308l4.372 4.858A.5.5 0 0 1 7 8.5v5.306l2-.666V8.5a.5.5 0 0 1 .128-.334L13.5 3.308V2h-11z"/>
                              </svg>
                        </button>
                        <div class="dropdown-content-icon-orderby">
                            <button onclick="OrderTasksBy('priority')" style="all:unset; width: 100% !important;padding:.8em" class="button-orderby">ORDER BY <strong>PRIORITY</strong></button>
                            <button onclick="OrderTasksBy('date')" style="all:unset; width: 100% !important;padding:.8em" class="button-orderby">ORDER BY <strong>DATE</strong></button>
                            <button onclick="OrderTasksBy('duration')" style="all:unset;width: 100% !important;padding:.8em" class="button-orderby">ORDER BY <strong>DURATION</strong></button>
                        </div>
                    </div>                      
                    <button id="reverse-order-icon" onclick="ReverseList()" style="all:unset; margin-left: .3rem">
                        <svg xmlns="http://www.w3.org/2000/svg" width="1.4rem" height="1.4rem" fill="#878787" class="bi bi-sort-down" viewBox="0 0 16 16">
                            <path d="M3.5 2.5a.5.5 0 0 0-1 0v8.793l-1.146-1.147a.5.5 0 0 0-.708.708l2 1.999.007.007a.497.497 0 0 0 .7-.006l2-2a.5.5 0 0 0-.707-.708L3.5 11.293V2.5zm3.5 1a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zM7.5 6a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zm0 3a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1h-3zm0 3a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z"/>
                          </svg>
                    </button>
                </div>
            </div>
            <hr style="width: 100%!important; border-width: thin!important;border-color: #191C24!important;  border-style: solid;">
            <div style="display: flex; width: 100%;height: 100%; overflow-y: scroll;" id="scrollbar-tasks-listed">
                <div id="task-list" style="display: flex;flex-direction:column-reverse;height: fit-content;width: 100%;">
        
                </div>
            </div>
            <hr style="width: 100%!important; border-width: thin!important;border-color: #191C24!important; border-style: solid;">
            <div id="container-bottom-buttons" style="display: flex; flex-direction: row;justify-content: flex-end;padding: 0 0.5em">
                <button id="reset-localstorage" style="all:unset">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.3rem" height="1.3rem" fill="#3E4559" class="bi bi-trash3-fill" viewBox="0 0 16 16">
                        <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
                      </svg>    
                </button>
                <button id="show-bin" onclick="ShowTasksBin()" style="all:unset; margin-left: .8rem">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.3rem" height="1.3rem" fill="#3E4559" class="bi bi-recycle" viewBox="0 0 16 16">
                        <path d="M9.302 1.256a1.5 1.5 0 0 0-2.604 0l-1.704 2.98a.5.5 0 0 0 .869.497l1.703-2.981a.5.5 0 0 1 .868 0l2.54 4.444-1.256-.337a.5.5 0 1 0-.26.966l2.415.647a.5.5 0 0 0 .613-.353l.647-2.415a.5.5 0 1 0-.966-.259l-.333 1.242-2.532-4.431zM2.973 7.773l-1.255.337a.5.5 0 1 1-.26-.966l2.416-.647a.5.5 0 0 1 .612.353l.647 2.415a.5.5 0 0 1-.966.259l-.333-1.242-2.545 4.454a.5.5 0 0 0 .434.748H5a.5.5 0 0 1 0 1H1.723A1.5 1.5 0 0 1 .421 12.24l2.552-4.467zm10.89 1.463a.5.5 0 1 0-.868.496l1.716 3.004a.5.5 0 0 1-.434.748h-5.57l.647-.646a.5.5 0 1 0-.708-.707l-1.5 1.5a.498.498 0 0 0 0 .707l1.5 1.5a.5.5 0 1 0 .708-.707l-.647-.647h5.57a1.5 1.5 0 0 0 1.302-2.244l-1.716-3.004z"/>
                      </svg>
                </button>
            </div>
        </div>
        <div id="container-tasks-infos">
            <div id="task-form">
                <span style="font-size: x-large; font-weight: bold; color: #3e4559;margin-bottom:1em">Add New Task</span>
                <form id="new-task-form">
                    <label for="title" style="margin-bottom: 0.3em; color: #cfd1d6; font-weight: lighter; font-style: italic;font-family: 'Ubuntu Mono', ui-monospace, monospace !important">Title:</label>
                    <input spellcheck="false" type="text" id="title" name="title" required autocomplete="off" style="all: unset; background-color: #191c24 !important; color: #f1f1f1 !important; font-size: larger !important; padding: 0.4em !important; border-radius: 3px !important;">
                    
                    <label for="description" style="margin-top:1.1em;margin-bottom: 0.3em; color: #cfd1d6; font-weight: lighter; font-style: italic;font-family: 'Ubuntu Mono', ui-monospace, monospace !important">Description:</label>
                    <textarea spellcheck="false" id="description" name="description" style="all: unset; background-color: #191c24 !important; color: #f1f1f1 !important; line-height: 1.3 !important; padding: 0.3em !important; border-radius: 3px !important;resize: none!important; white-space: pre-wrap!important;height: 100%!important;overflow-wrap: break-word!important;font-weight: lighter !important;"></textarea>
                    
                    <label for="priority" style="margin-top:1.1em;margin-bottom: 0.3em; color: #cfd1d6; font-weight: lighter; font-style: italic;font-family: 'Ubuntu Mono', ui-monospace, monospace !important">Priority:</label>
                    <select id="priority" name="priority" style="all: unset; background-color: #12141a !important; padding: 0.4em !important; border-radius: 4px !important;">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                    
                    <button id="add-new-task-button" type="submit" style="all:unset;padding: 0.7em 1.1em; background-color: #3E4559; border-radius: 0.5em; margin-top: 2.2em;    width: fit-content;">
                        <div style="display: flex;flex-direction: row;align-items: center;justify-content: center;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#FFFFFF" class="bi bi-plus-lg" viewBox="0 0 16 16" style="margin-right: .2em;">
                            <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2Z"/>
                            </svg>
                            <span style="font-size: smaller;height: fit-content;font-style: italic;font-weight: 500;color: #FFFFFF">Add Task</span>
                        </div>
                    </button>
                </form>
            </div>
            <div id="task-selected">
                <div id="container-task-selected-infos-plus-buttons"> 
                    <input id="id-task-selected" style="display: none;">
                    <div style="display: flex; flex-direction: row; justify-content: space-between;align-items: flex-end;">
                        <span id="date_task" style="height: fit-content; font-family: 'Ubuntu Mono', ui-monospace, monospace; font-size: small; text-decoration: underline; font-style: italic; color: #878787;user-select: none;"></span>
                        <button id="close-selected-task" onclick="CloseTask()" style="all:unset; cursor:pointer">
                            <svg id="close-selected-task-icon" xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="#3E4559" class="bi bi-dash-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM4.5 7.5a.5.5 0 0 0 0 1h7a.5.5 0 0 0 0-1h-7z"></path>
                            </svg>
                        </button>
                    </div>
                    <div style="display: flex; height: 100%;">
                        <form id="task-selected-form" style="width: 100%; display: flex; flex-direction: column;">
                            <div id="title-task-selected" contenteditable spellcheck="false" style="padding-top: 0.8rem !important;font-size: x-large !important; font-weight: 500 !important;">
                            </div>

                            <textarea onkeydown="if(event.keyCode===9){var v=this.value,s=this.selectionStart,e=this.selectionEnd;this.value=v.substring(0, s)+'\t'+v.substring(e);this.selectionStart=this.selectionEnd=s+1;return false;}" id="description-task-selected" name="description" style="resize: none !important; white-space: pre-wrap !important; height: 100% !important; all: unset; overflow-wrap: break-word !important;margin-top:1.6rem !important; margin-bottom:1.5rem !important; font-weight: lighter!important; font-size: medium !important;line-height: 1.5 !important;" spellcheck="false"></textarea>
                            
                            <div style="display: flex; flex-direction: row;">
                                <div id="circle-priority" style="border-radius: 100%;height: 1.2em; width: 1.2em;margin-right: 0.5em;"></div>
                                <select id="priority-task-selected" name="priority" style="all:unset; height: fit-content; cursor: pointer;font-size: medium; font-weight: 500; font-style: italic;">
                                    <option id="low-option" value="low" style="background-color: #12141A !important;">Low</option>
                                    <option id="medium-option" value="medium" style="background-color: #12141A !important;">Medium</option>
                                    <option id="high-option" value="high" style="background-color: #12141A !important;">High</option>
                                </select>
                            </div>
                            <div style="display: flex; flex-direction: row-reverse;">
                                <button id="button-edit-icon" type="submit" onclick="UpdateTask(true)" style="all:unset;padding: .5em .9em;background-color: #3E4559;border-radius: .3em;margin-bottom: .8em;">
                                    <div style="display: flex;flex-direction: row;align-items: center;justify-content: center;">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#FFFFFF" class="bi bi-pen" viewBox="0 0 16 16" style="margin-right: .2em;">
                                            <path d="m13.498.795.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"></path>
                                        </svg>
                                        <span style="font-size: smaller;height: fit-content;font-style: italic;font-weight: 500;color: #FFFFFF">Save Edit</span>
                                    </div>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                <div id="container-cronometer">
                    <input id="duration-task-selected" style="display: none;">
                    <div class="buttons" style="display: flex; flex-direction: row;">
                        <button id="resetTimer" style="all:unset; margin-right: 1.2em;cursor: pointer !important;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="3.2em" height="3.2em" fill="#3E4559" class="bi bi-arrow-clockwise" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                                <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                            </svg>
                        </button>
                        <button id="pauseTimer" accesskey="" style="display: none !important; all:unset; cursor: pointer !important;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="3.2em" height="3.2em" fill="#7B85A4" class="bi bi-pause-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM6.25 5C5.56 5 5 5.56 5 6.25v3.5a1.25 1.25 0 1 0 2.5 0v-3.5C7.5 5.56 6.94 5 6.25 5zm3.5 0c-.69 0-1.25.56-1.25 1.25v3.5a1.25 1.25 0 1 0 2.5 0v-3.5C11 5.56 10.44 5 9.75 5z"/>
                              </svg>
                        </button>
                        <button id="startTimer" accesskey=" " style="all:unset; cursor: pointer !important;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="3.2em" height="3.2em" fill="#7B85A4" class="bi bi-play-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM6.79 5.093A.5.5 0 0 0 6 5.5v5a.5.5 0 0 0 .79.407l3.5-2.5a.5.5 0 0 0 0-.814l-3.5-2.5z"/>
                              </svg>
                        </button>
                    </div>
                    <div class="timerDisplay" style="height: fit-content; font-family: 'Ubuntu Mono', ui-monospace, monospace; font-size: 3.5em;color:#9FA8C3">
                        00<span style="color: #3E4559!important;">:</span>00<span style="color:#3E4559!important">:</span>00
                    </div>
                </div>
            </div>
        </div>
        <div id="bin-div">
            <div id="container-bin-div-all" style="width: 100%; height: 100%; display: flex; flex-direction: row;">
                <div id="container-bin-tasks">
                    <span style="color: #1e212b; font-size: smaller; text-transform: uppercase; font-family: 'Ubuntu Mono', ui-monospace, monospace; font-weight: bold;">Last 7 days removed tasks</span>
                    <hr style="width: 100%!important; border-width: thin!important;border-color: #191C24!important;  border-style: solid;">
                    <div style="display: flex; width: 100%;height: 100%; overflow-y: scroll;" id="scrollbar-tasks-bin">
                        <div id="bin-tasks" style="display: flex;flex-direction:column-reverse;height: fit-content;width: 100%;">
                
                        </div>
                    </div>
                    <hr style="width: 100%!important; border-width: thin!important;border-color: #191C24!important; border-style: solid;">
                    <button id="reset-all-definitely" onclick="ResetAllDefinitely()" style="all:unset;padding: 0.5em 0.9em; background-color: #3E4559; border-radius: 0.6em; margin-bottom: 0.8em;">
                        <div style="display: flex;flex-direction: row;align-items: center;justify-content: center;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#FFFFFF" class="bi bi-trash3" viewBox="0 0 16 16" style="margin-right: .2em;">
                                <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
                            </svg>
                            <span style="font-size: smaller;height: fit-content;font-style: italic;font-weight: 500;color: #FFFFFF">Clean Trash</span>
                        </div>
                    </button>
                </div>
                <div style="flex:auto;">
                    <button id="go-back-previous" style="all: unset; width: 100% !important; height: 100% !important; display: flex !important; justify-content: flex-start !important; align-items: center!important;">
                        <div id="bar-button-go-back">
                            <svg xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem" fill="#12141A" class="bi bi-caret-left-fill" viewBox="0 0 16 16">
                                    <path d="m3.86 8.753 5.482 4.796c.646.566 1.658.106 1.658-.753V3.204a1 1 0 0 0-1.659-.753l-5.48 4.796a1 1 0 0 0 0 1.506z"/>
                                </svg>    
                        </div>
                    </button>
                </div>
            </div>
        </div>
        <div id="navbar-bottom-short-view">
            <div id="container-navbar-buttons" style="display: flex; flex-direction: row;justify-content: flex-end;padding: 0 0.5em; align-items: center;">
                <div style="margin-right: 1em;">
                    <button id="add-task-btn-short-view" style="all:unset">
                        <svg xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem" fill="#878787" class="bi bi-plus-circle-fill" viewBox="0 0 16 16">
                            <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"></path>
                          </svg>
                    </button>
                </div>
                <div>                   
                    <button id="toggle-button-list-tasks" onclick="ToggleIconTouch(this.value)" style="all:unset" value="close">
                          <svg id="#toggle-icon-list-tasks" xmlns="http://www.w3.org/2000/svg" width="2rem" height="2rem" fill="#878787" class="bi bi-chevron-compact-down" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1.553 6.776a.5.5 0 0 1 .67-.223L8 9.44l5.776-2.888a.5.5 0 1 1 .448.894l-6 3a.5.5 0 0 1-.448 0l-6-3a.5.5 0 0 1-.223-.67z"/>
                          </svg>
                    </button>
                </div>
            </div>
        </div>
    </body>
</html>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap');
    body{
        background-color: #191C24;
        margin: 0 !important;
        padding: 0 !important;
        display: flex;
        flex-direction: row;
        font-family: Ubuntu, system-ui, sans-serif;
        color: whitesmoke;
        overflow-x: hidden;
        width: 100vw;
        height: 100vh;

    }
    #container-tasks-buttons{
        width: 30vw !important;
        background-color: #12141A;
        height: 100vh !important;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        padding: 0.8rem 0.5rem;
        display: flex;
        flex-direction: column;
    }
    #container-bin-tasks{
        width: 30vw !important;
        background-color: #12141A;
        height: 100vh !important;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        padding: 0.8rem 0.5rem;
        display: flex;
        flex-direction: column;
    }
    #bar-button-go-back{
        width: 1.5rem;
        height: 100%;
        display: flex;
        align-items: center;
        background-color: #191c24;
    }
    #go-back-previous:hover > #bar-button-go-back{
        background-color: #292c37;
        cursor: pointer !important;
    }
    #container-tasks-infos{
        width: 69.9vw !important;
        height: 100vh !important;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        padding: 2.1rem 11% 4rem 11%;
    }
    #task-form {
        display: none;
        flex-direction: column;
        background-color: #1E212B;
        border-radius: 0.7em;
        height: 100%;
        width: 100%;
        border-top: 0.7em solid #12141A;
        border-bottom: 0.7em solid #12141A;
        box-shadow: 4px 4px 10px 1px #00000026;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        padding: 1.2em 1.5em;
    }
    #new-task-form{
        display: flex;
        flex-direction: column;
        width:100%;
        height: 100%;
        justify-content: space-between;
    }
    #task-selected {
        display: none;
        flex-direction: column;
        justify-content: space-between;
        background-color: #1E212B;
        border-radius: 0.7em;
        height: 100%;
        width: 100%;
        border-top: 0.7em solid #12141A;
        border-bottom: 0.7em solid #12141A;
        box-shadow: 4px 4px 10px 1px #00000026;
    }
    #container-cronometer{
        background-color: #12141A;
        width: 100%;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        padding: 1.8rem 1.5em 1rem 1.5em;
        display: flex;
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
    }
    #container-task-selected-infos-plus-buttons{
        height: 100%;
        padding: 1.2em 1.5em 0px 1.5em;
        display: flex;
        flex-direction: column;
    }
    #description-task-selected::-webkit-scrollbar-track, #scrollbar-tasks-listed::-webkit-scrollbar-track, #scrollbar-tasks-bin::-webkit-scrollbar-track, #description::-webkit-scrollbar-track{
        background-color: transparent;
    }
    #description-task-selected::-webkit-scrollbar, #scrollbar-tasks-listed::-webkit-scrollbar, #scrollbar-tasks-bin::-webkit-scrollbar, #description::-webkit-scrollbar{
        width: 3px;
    }
    #description-task-selected::-webkit-scrollbar-thumb, #scrollbar-tasks-listed::-webkit-scrollbar-thumb, #scrollbar-tasks-bin::-webkit-scrollbar-thumb, #description::-webkit-scrollbar-thumb{
        border-radius: 3px;
        background-color: rgba(128, 128, 128, 0.308);
    }
    [contenteditable] {
        outline: 0px solid transparent;
    }
    #bin-div {
        display: none;
    }
    #close-selected-task-icon:hover{
        fill: #77819e !important    
    }
    #pauseTimer:hover svg{
        fill: #cfd1d6 !important;    
    }
    #startTimer:hover svg{
        fill: #cfd1d6 !important    
    }
    #resetTimer:hover svg{
        fill: #cfd1d6 !important    
    }
    #button-edit-icon:hover, #reset-all-definitely:hover, #add-new-task-button:hover{
        background-color: #77819e !important;
        cursor: pointer !important;
    }
    .dropbtn-icon-orderby {
        padding: 1em;
        font-size: 1em;
        border: none;
    }
    .dropdown-icon-orderby {
        position: relative;
        display: inline-block;
        direction: rtl !important;
    }
    .dropdown-content-icon-orderby {
        display: none;
        position: absolute;
        background-color: #f1f1f1;
        box-shadow: 0px 8px 9px 1px rgba(0,0,0,0.2);
        z-index: 1;
        font-size: smaller;
    }
    .dropdown-icon-orderby:hover .dropdown-content-icon-orderby {
        display: block;
    }
    .dropdown-content-icon-orderby > button:hover{
        background-color: #1a2030 !important;
        cursor: pointer !important
    }
    .dropdown-content-icon-orderby > button{
        background-color: #12141A !important;
    }
    #add-task-btn:hover svg{
        fill: #cfd1d6 !important;    
        cursor: pointer !important;
    }
    #reverse-order-icon:hover svg{
        fill: #cfd1d6 !important;
        cursor: pointer !important;   
    }
    #show-bin:hover svg{
        fill: #cfd1d6 !important;
        cursor: pointer !important;   
    }
    #reset-localstorage:hover svg{
        fill: #cfd1d6 !important;
        cursor: pointer !important;   
    }
    #remove-task-listed:hover svg{
        fill: #cfd1d6 !important;
    }
    .task-listed{
        margin-bottom: 0.5em;
        /* padding: 1.1em 0.6em 1.1em 0.8em; */
        background-color: #191c2450; 
        border-radius: .4em;
        display: flex; 
        align-items: flex-start; 
        justify-content: space-between; 
        flex-direction: row;
        /* width: 100%; */
    }
    .task-listed.low{
        border-left: .6em solid  #363f91;
    }
    .task-listed.medium{
        border-left: .6em solid #E69A2D ;
    }
    .task-listed.high{
        border-left: .6em solid #C20628 ;
    }
    .task-listed-last-div{
        display: flex; 
        width: 100%; 
        justify-content: flex-start; 
        flex-direction: row; 
        color: #3E4559; 
        font-size: small; 
        font-family: 'Ubuntu Mono',ui-monospace, monospace;
    }
    .task-listed-middle-div{
        color: #878787; 
        font-size: smaller;
        margin-bottom: 1em; 
        font-family: 'Ubuntu Mono',ui-monospace, monospace;
    }
    .task-list-title-format *{
        white-space: nowrap !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        display: block;
    }
    .bin-task-listed{
        border-left: 0.4em solid #292c37;
        margin-bottom: 0.5em;
        background-color: #191c2450; 
        border-radius: .4em;
        display: flex; 
        align-items: flex-start; 
        justify-content: space-between; 
        flex-direction: row;
    }
    .bin-task-listed-last-div{
        display: flex; 
        width: 100%; 
        justify-content: flex-start; 
        flex-direction: row; 
        color: #3E4559; 
        font-size: small; 
        font-family: 'Ubuntu Mono',ui-monospace, monospace;
    }
    .bin-task-listed-middle-div{
        color: #878787; 
        font-size: smaller;
        margin-bottom: 1em; 
        font-family: 'Ubuntu Mono',ui-monospace, monospace;
    }
    .bin-task-list-title-format *{
        white-space: nowrap !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        display: block;
    }
    #restore-bin-task:hover svg{
        fill: #FFFFFF !important;
        cursor: pointer
    }
    #bin-div{
        width: 100vw;
        height: 100vh;
        background-color: #000000b0;
        position: absolute;
        z-index: 100;
        backdrop-filter: blur(0.2rem);
    }
    #navbar-bottom-short-view{
        width: 100%;
        padding: 0.8rem 0.5rem;
        background-color: #12141A;
        border-top: .5em solid #191C24;
        -webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
        -moz-box-sizing: border-box;    /* Firefox, other Gecko */
        box-sizing: border-box;         /* Opera/IE 8+ */
        display: none;
    }

    .rot{
        transform: rotate(180deg) !important;
    }
    
    #toggle-button-list-tasks{
        -webkit-transition: all 500ms ease !important;
        -moz-transition: all 500ms ease !important;
        -ms-transition: all 500ms ease !important;
        -o-transition: all 500ms ease !important;
        transition: all 500ms ease !important;
    }

</style>

<style>
    @media (max-width: 959px) {
        body{
            flex-direction: column;
        }
        #navbar-bottom-short-view{
            display: block;
        }
        #container-tasks-infos{
            display: none;
        }
        #container-tasks-buttons, #container-tasks-infos{
            width: 100% !important;
        }
        #container-tasks-infos{
            padding: 2.1rem 2.1rem 4rem 2.1rem !important
        }
        #container-cronometer{
            padding: 1.8rem 1.2em 1rem 1.2em !important;
        }
        .timerDisplay{
            font-size: 2.5rem !important;
        }
        #startTimer svg, #pauseTimer svg, #resetTimer svg{
            width: 2.5rem !important;
            height: 2.5rem !important;
        }
        #resetTimer{
            margin-right: .8em !important
        }
        .add-task-btn-wide-view{
            display: none !important;
        }
        #container-bin-div-all{
            flex-direction: column !important;
        }
        #container-bin-tasks{
            width: 100% !important;
        }
        #bar-button-go-back{
            width: 100% !important;
            justify-content: center !important;
            padding: 0.5rem 0 1rem 0 !important;
            -webkit-box-sizing: border-box !important;
            -moz-box-sizing: border-box !important;
            box-sizing: border-box !important;
        }
        #bar-button-go-back > svg{
            transform: rotate(90deg) !important;
        }
        #reverse-order-icon svg, .dropbtn-icon-orderby svg{
            width: 1.8rem !important;
            height: 1.8rem !important;
        }
        #show-bin svg, #reset-localstorage svg{
            width: 1.7rem !important;
            height: 1.7rem !important;
        }
        #reverse-order-icon{
            margin-left: .6rem !important;
        }
        #show-bin {
            margin-left: .9rem !important;
        }
    }
    @media (min-width: 960px) {
        #container-tasks-infos{
            display: flex !important;
        }
        #container-tasks-buttons{
            display: flex !important;
        }
    }

</style>

<script>
    const addTaskButton = document.getElementById("add-task-btn")
    const taskForm = document.getElementById("task-form")
    const newTaskForm = document.getElementById("new-task-form")
    
    const resetLocalStorage = document.getElementById("reset-localstorage")
    resetLocalStorage.addEventListener("click", () => {
        const isConfirmed = window.confirm('Are you sure to reset tasks?');
        if (isConfirmed){
            try{
                const ids_list = Object.keys(JSON.parse(localStorage.getItem("tasks")))
                for (i in ids_list){
                    RemoveTask(ids_list[i], verbose=false)
                }
            }
            catch(e){}
            document.getElementById("task-list").innerHTML = "";
            alert("Tasks deleted!");
        }
    });

    document.getElementById("add-task-btn-short-view").addEventListener("click", ()=>{
        CloseTask()
        try{ 
            document.getElementById('pauseTimer').click()
            UpdateTask();
        }
        catch (e) {}
        taskForm.style.display = "flex";

        document.getElementById("container-tasks-buttons").style.display = "none";
        document.getElementById("container-tasks-infos").style.display = "flex";
        document.getElementById("toggle-button-list-tasks").value = "open";
        if(document.getElementById("toggle-button-list-tasks").classList.length==0){
            document.getElementById("toggle-button-list-tasks").classList.toggle("rot")
        }
    })

    addTaskButton.addEventListener("click", () => {
        CloseTask()
        try{ 
            document.getElementById('pauseTimer').click()
            UpdateTask();
        }
        catch (e) {}
        taskForm.style.display = "flex";
    });

    function formatTimestamp() {
        const now = new Date();
        const timestamp = `${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}${now.getHours().toString().padStart(2, '0')}${now.getMinutes().toString().padStart(2, '0')}${now.getSeconds().toString().padStart(2, '0')}`;
        return timestamp;
    }

    function formatDate(date_string){
        var months = [ "January", "February", "March", "April", "May", "June", 
           "July", "August", "September", "October", "November", "December" ];
        var year = date_string.slice(0,4)
        var month = months[parseInt(date_string.slice(4,6))-1];
        var day = date_string.slice(6,8)
        return `${day} ${month} ${year}`
    }
    
    newTaskForm.addEventListener("submit", () => {
        event.preventDefault();
        const title = document.getElementById("title").value;
        const description = document.getElementById("description").value;
        const priority = document.getElementById("priority").value;

        const id_task = formatTimestamp();
        const task = { 
                title: title,
                description: description,
                priority: priority,
                duration: 0,
                id: id_task
            };
        
        const existingTasks = JSON.parse(localStorage.getItem("tasks")) || {};
        existingTasks[id_task] = task;

        localStorage.setItem("tasks", JSON.stringify(existingTasks));

        newTaskForm.reset();
        taskForm.style.display = "none";

        alert("Task added successfully!");

        const new_task_div = `
        <div id="div-task-${task.id}" class="task-listed ${priority}">
            <div style='width:100%!important;overflow: hidden;'>
                <button id='task-listed' onClick='ShowTask(${task.id})' style='all:unset; width:100%!important; padding: 1.1em 0em 1.1em 0.8em;cursor: pointer;-webkit-box-sizing: border-box !important; -moz-box-sizing: border-box !important;box-sizing: border-box !important;'>
                    <div style="margin-bottom: .4em; ">
                        <span class="task-list-title-format" id="task-list-title-${task.id}" style="color: #CFCFCF;white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${title} </span>
                    </div>
                    <div class="task-listed-middle-div">
                        <span id="task-list-date-${task.id}" style="white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${formatDate(task.id)} </span>
                    </div>
                    <div class="task-listed-last-div">
                        <div style="flex: 50%">
                            Priority: <span id="task-list-priority-${task.id}" style="text-transform: capitalize; font-weight: 600"> ${priority} </span>
                        </div>
                        <div style="flex: 50%">
                            Duration: <span id="task-list-duration-${task.id}" style="font-weight: 600"> ${formatDuration(task.duration)} </span>
                        </div>
                    </div>
                </button>
            </div>
            <div style="padding: .9em 0.6em .9em 0em;">
                <button id='remove-task-listed' onclick="RemoveTask(${task.id})" style="all:unset">
                    <svg xmlns="http://www.w3.org/2000/svg" width="1.8em" height="1.8em" fill="#3E4559" class="bi bi-x" viewBox="0 0 16 16">
                        <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                </button>     
            </div>
        </div>
        `
        $("#task-list").append(new_task_div)
        ShowTask(id_task);
    })

    function UpdateTask(prevent=true){
        var id_task = document.getElementById("id-task-selected").value;
        var title_prev = document.getElementById("title-task-selected").innerHTML;
        var title = title_prev.trim() != "" ? title_prev : "Task Title";
        var description = document.getElementById("description-task-selected").value;
        var priority = document.getElementById("priority-task-selected").value;
        var duration = document.getElementById("duration-task-selected").value;

        const existingTasks = JSON.parse(localStorage.getItem("tasks"));
        existingTasks[id_task]['duration'] = duration;
        existingTasks[id_task]['description'] = description;
        existingTasks[id_task]['priority'] = priority;
        existingTasks[id_task]['title'] = title;
        localStorage.setItem("tasks", JSON.stringify(existingTasks));


        document.getElementById(`task-list-title-${id_task}`).innerHTML = title;
        document.getElementById(`task-list-priority-${id_task}`).innerHTML = priority;
        document.getElementById(`task-list-duration-${id_task}`).innerHTML = formatDuration(duration);
        var class_priority = document.getElementById(`div-task-${id_task}`).classList;
        class_priority.remove(class_priority[1]);
        class_priority.add(priority);


        if(prevent){
            event.preventDefault();
        }
        console.log(`Update in "${title}" - id: ${id_task}`)
    }

    function formatDuration(duration=null){
        if(duration == null){
            var duration = document.getElementById("duration-task-selected").value;
        }
        var timerRef = document.querySelector('.timerDisplay');
        let hours = Math.floor(duration/3600)
        let minutes = Math.floor((duration%3600)/60)
        let seconds = (duration%3600)%60
        let h = hours < 10 ? "0" + hours : hours;
        let m = minutes < 10 ? "0" + minutes : minutes;
        let s = seconds < 10 ? "0" + seconds : seconds;

        timerRef.innerHTML = ` ${h}<span style="color:#3E4559!important">:</span>${m}<span style="color:#3E4559!important">:</span>${s}`;
        var format_time = hours == 0 ? `${m}min` : `${h}h${m}min`
        return format_time;
    }

    function ShowTask(id) {
        document.getElementById('pauseTimer').click()
        try{ UpdateTask() }
        catch (e) {}
        var title = document.getElementById("title-task-selected");
        var description = document.getElementById("description-task-selected");
        var priority = document.getElementById("priority-task-selected");
        var duration = document.getElementById("duration-task-selected");
        var id_label = document.getElementById("id-task-selected");
        var date_task = document.getElementById("date_task");
        
        var infos = JSON.parse(localStorage.getItem("tasks"))[id];

        title.innerHTML = infos.title;
        description.value = infos.description;
        priority.value = infos.priority;
        duration.value = infos.duration;
        id_label.value = infos.id;
        date_task.innerHTML = formatDate(infos.id);
        CircleColorize(infos.priority);

        formatDuration();

        taskForm.style.display = "none";
        $("#task-selected")[0].style.display = "flex";

        let width_screen = screen.width;
        if(width_screen<=959){
            document.getElementById("container-tasks-buttons").style.display = "none";
            document.getElementById("container-tasks-infos").style.display = "flex";
            document.getElementById("toggle-button-list-tasks").value = "open";
            if(document.getElementById("toggle-button-list-tasks").classList.length==0){
                document.getElementById("toggle-button-list-tasks").classList.toggle("rot")
            }
        }
    }

    function CloseTask(){
        document.getElementById('pauseTimer').click()
        try{ UpdateTask() }
        catch (e) {}
        $("#task-selected")[0].style.display = "none";
    }

    window.addEventListener('beforeunload', (event) => {
        event.preventDefault();
        try{ UpdateTask() }
        catch (e) {}
    });

    document.addEventListener("DOMContentLoaded", (event) => {
        const existingTasks = JSON.parse(localStorage.getItem("tasks"));
        if(existingTasks){
            var tasks_to_list = Object.values(existingTasks)
            for (let i = 0; i < tasks_to_list.length; i++) {
                var task = tasks_to_list[i];
                const pop_task_div = `
                <div id="div-task-${task.id}" class="task-listed ${task.priority}">
                    <div style='width:100%!important;overflow: hidden;'>
                        <button id='task-listed' onClick='ShowTask(${task.id})' style='all:unset; width:100%!important; padding: 1.1em 0em 1.1em 0.8em;cursor: pointer;-webkit-box-sizing: border-box !important; -moz-box-sizing: border-box !important;box-sizing: border-box !important;'>
                            <div style="margin-bottom: .4em; ">
                                <span class="task-list-title-format" id="task-list-title-${task.id}" style="color: #CFCFCF;white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${task.title} </span>
                            </div>
                            <div class="task-listed-middle-div">
                                <span id="task-list-date-${task.id}" style="white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${formatDate(task.id)} </span>
                            </div>
                            <div class="task-listed-last-div">
                                <div style="flex: 50%">
                                    Priority: <span id="task-list-priority-${task.id}" style="text-transform: capitalize; font-weight: 600"> ${task.priority} </span>
                                </div>
                                <div style="flex: 50%">
                                    Duration: <span id="task-list-duration-${task.id}" style="font-weight: 600"> ${formatDuration(task.duration)} </span>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div style="padding: .9em 0.6em .9em 0em;">
                        <button id='remove-task-listed' onclick="RemoveTask(${task.id})" style="all:unset">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1.8em" height="1.8em" fill="#3E4559" class="bi bi-x" viewBox="0 0 16 16">
                                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                            </svg>
                        </button>     
                    </div>
                </div>
                `
                $("#task-list").append(pop_task_div)
            }
        }
        DeleteBinTaskByDate();
        AdjustHeight()
    });

    function OrderTasksBy(orderby){
        const existingTasks = JSON.parse(localStorage.getItem("tasks"));
        if(existingTasks){
            var tasks_to_list = Object.values(existingTasks)
            for (let i = 0; i < tasks_to_list.length; i++) {
                var task = tasks_to_list[i];
                if(orderby=="duration"){
                    document.getElementById(`div-task-${task.id}`).style.order = task.duration
                }
                else if(orderby=="priority"){
                    var priority_number = task.priority == "low" ? 1 : task.priority == "medium" ? 2 : 3
                    document.getElementById(`div-task-${task.id}`).style.order = priority_number
                } 
                else{
                    document.getElementById(`div-task-${task.id}`).style.order = task.id
                }
            }
        }
    }

    function ReverseList(){
        var direction = $("#task-list")[0].style['flex-direction'];
        if(direction == "column"){
            $("#task-list")[0].style['flex-direction'] = 'column-reverse'
            return
        }
        else{
            $("#task-list")[0].style['flex-direction'] = 'column'
            return
        }
    }

    function RemoveTask(id, verbose=true){
        if(verbose){
            var isConfirmed = window.confirm('Are you sure to delete this task?');
        }
        else{
            var isConfirmed = true
        }
        if(isConfirmed){
            var existingTasks = JSON.parse(localStorage.getItem("tasks"))
            try{
                const task_deleted = existingTasks[id];
                task_deleted['deleted_date'] = new Date().getTime();
                
                var removedTasks = JSON.parse(localStorage.getItem("removed_tasks")) || {};
                removedTasks[id] = task_deleted;
                
                localStorage.setItem("removed_tasks", JSON.stringify(removedTasks));
    
                delete existingTasks[id];
                localStorage.setItem("tasks", JSON.stringify(existingTasks));
            }
            catch(e){}
            document.getElementById(`div-task-${id}`).remove();
            try{
                if(document.getElementById('id-task-selected').value == id){
                    document.getElementById('task-selected').style.display = 'none'
                }
            }
            catch(e){}
        }
    }

    function ShowTasksBin(){
        try{ 
            document.getElementById('pauseTimer').click()
            UpdateTask();
        }
        catch (e) {}
        const removedTasks = JSON.parse(localStorage.getItem("removed_tasks"));
        if(removedTasks && Object.keys(removedTasks).length != 0){
            var tasks_to_list = Object.values(removedTasks)
            for (let i = 0; i < tasks_to_list.length; i++) {
                var task = tasks_to_list[i];
                const pop_task_div = `
                <div id="bin-task-${task.id}" class="bin-task-listed">
                    <div style='width:100%!important;overflow: hidden;'>
                        <div id='bin-task-listed' style='all:unset; width:100%!important; padding: 1.1em 0em 1.1em 0.8em;-webkit-box-sizing: border-box !important; -moz-box-sizing: border-box !important;box-sizing: border-box !important;display:flex;flex-direction:column'>
                            <div style="margin-bottom: .4em; ">
                                <span class="bin-task-list-title-format" id="bin-task-list-title-${task.id}" style="color: #CFCFCF;white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${task.title} </span>
                            </div>
                            <div class="bin-task-listed-middle-div">
                                <span id="bin-task-list-date-${task.id}" style="white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> Created in: ${formatDate(task.id)} </span>
                            </div>
                            <div class="bin-task-listed-last-div">
                                <div style="flex: 50%">
                                    Priority: <span id="bin-task-list-priority-${task.id}" style="text-transform: capitalize; font-weight: 600"> ${task.priority} </span>
                                </div>
                                <div style="flex: 50%">
                                    Duration: <span id="bin-task-list-duration-${task.id}" style="font-weight: 600"> ${formatDuration(task.duration)} </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="padding: .9em 0.6em .9em 0em;">
                        <button id='restore-bin-task' onclick='RestoreTask(${task.id})' style="all:unset">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1.3em" height="1.3em" fill="#878787" class="bi bi-arrow-return-left" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M14.5 1.5a.5.5 0 0 1 .5.5v4.8a2.5 2.5 0 0 1-2.5 2.5H2.707l3.347 3.346a.5.5 0 0 1-.708.708l-4.2-4.2a.5.5 0 0 1 0-.708l4-4a.5.5 0 1 1 .708.708L2.707 8.3H12.5A1.5 1.5 0 0 0 14 6.8V2a.5.5 0 0 1 .5-.5z"/>
                            </svg>
                        </button>     
                    </div>
                </div>
                `
                
                $("#bin-tasks").append(pop_task_div)
            }
            $("#bin-div")[0].style.display = "flex"
            document.getElementById(`task-list-duration-${document.getElementById("id-task-selected").value}`).innerHTML = formatDuration(document.getElementById("duration-task-selected").value);
        }
        else {
            alert("There isn't deleted tasks yet.")
        }
    }

    function DeleteBinTaskByDate(){
        const today = (new Date()).getTime();
        try{
            const removedTasks = JSON.parse(localStorage.getItem("removed_tasks"));
            if(removedTasks && Object.keys(removedTasks).length != 0){
                var tasks_to_list = Object.values(removedTasks)
                for (let i = 0; i < tasks_to_list.length; i++) {
                    var task = tasks_to_list[i];
                    if(Math.floor((today - task.deleted_date)/(1000 * 3600 * 24)) >= 7){
                        delete removedTasks[task.id]
                    }
                }
                localStorage.setItem("removed_tasks", JSON.stringify(removedTasks));
            }
        }
        catch(e){}
    }

    function RestoreTask(id){
        try{
            var removedTasks = JSON.parse(localStorage.getItem("removed_tasks"));
            var task = removedTasks[id]
            delete removedTasks[id]
            localStorage.setItem("removed_tasks", JSON.stringify(removedTasks));
    
            delete task.deleted_date

            var existingTasks = JSON.parse(localStorage.getItem("tasks")) || {};
            existingTasks[id] = task;
            localStorage.setItem("tasks", JSON.stringify(existingTasks));
            document.getElementById(`bin-task-${id}`).remove();

            const pop_task_div = `
                <div id="div-task-${task.id}" class="task-listed ${task.priority}">
                    <div style='width:100%!important;overflow: hidden;'>
                        <button id='task-listed' onClick='ShowTask(${task.id})' style='all:unset; width:100%!important; padding: 1.1em 0em 1.1em 0.8em;cursor: pointer;-webkit-box-sizing: border-box !important; -moz-box-sizing: border-box !important;box-sizing: border-box !important;'>
                            <div style="margin-bottom: .4em; ">
                                <span class="task-list-title-format" id="task-list-title-${task.id}" style="color: #CFCFCF;white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${task.title} </span>
                            </div>
                            <div class="task-listed-middle-div">
                                <span id="task-list-date-${task.id}" style="white-space: nowrap !important; overflow: hidden !important; text-overflow: ellipsis !important; display: block;"> ${formatDate(task.id)} </span>
                            </div>
                            <div class="task-listed-last-div">
                                <div style="flex: 50%">
                                    Priority: <span id="task-list-priority-${task.id}" style="text-transform: capitalize; font-weight: 600"> ${task.priority} </span>
                                </div>
                                <div style="flex: 50%">
                                    Duration: <span id="task-list-duration-${task.id}" style="font-weight: 600"> ${formatDuration(task.duration)} </span>
                                </div>
                            </div>
                        </button>
                    </div>
                    <div style="padding: .9em 0.6em .9em 0em;">
                        <button id='remove-task-listed' onclick="RemoveTask(${task.id})" style="all:unset">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1.8em" height="1.8em" fill="#3E4559" class="bi bi-x" viewBox="0 0 16 16">
                                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                            </svg>
                        </button>     
                    </div>
                </div>
                `
            $("#task-list").append(pop_task_div)
            if(Object.keys(removedTasks).length == 0){
                document.getElementById("go-back-previous").click() 
            }
        }
        catch(e){}
    }

    function ResetAllDefinitely(){
        const isConfirmed = window.confirm('Are you sure to delete all definitely?');
        if (isConfirmed){
            localStorage.removeItem("removed_tasks");
            document.getElementById("go-back-previous").click()        
        }
    }

    document.getElementById("go-back-previous").addEventListener('click', () => {
        $("#bin-div")[0].style.display = "none"
        $("#bin-tasks")[0].innerHTML = ""
    });

    document.getElementById('priority-task-selected').addEventListener('change',()=>{
        CircleColorize(document.getElementById('priority-task-selected').value)
    });

    function CircleColorize(priority){
        if(priority=='low'){
            $("#circle-priority")[0].style['background-color']='#363f91'
        }
        else if(priority=='medium'){
            $("#circle-priority")[0].style['background-color']='#e69a2d'
        }else{
            $("#circle-priority")[0].style['background-color']='#c20628'
        }
    }

    function ToggleIconTouch(order){
        let width_screen = screen.width;
        
        if(width_screen <= 959){
            if(order == "close"){
                document.getElementById("container-tasks-buttons").style.display = "none";
                document.getElementById("container-tasks-infos").style.display = "flex";
                document.getElementById("toggle-button-list-tasks").value = "open";
                document.getElementById("toggle-button-list-tasks").classList.toggle("rot");
            }
            else{
                document.getElementById("container-tasks-buttons").style.display = "flex";
                document.getElementById("container-tasks-infos").style.display = "none";
                document.getElementById("toggle-button-list-tasks").value = "close";
                document.getElementById("toggle-button-list-tasks").classList.toggle("rot");
            }
        }
        else{
            document.getElementById("container-tasks-buttons").style.display = "flex";
            document.getElementById("container-tasks-infos").style.display = "flex";
        }
    }

    window.addEventListener("resize", AdjustHeight);

    function AdjustHeight(){
        let width_screen = screen.width;
        if(width_screen <= 959){
            var height_over = (screen.height - document.getElementById("navbar-bottom-short-view").offsetHeight) +"px"
            document.getElementById("container-tasks-buttons").style.setProperty('height', height_over, 'important')
            document.getElementById("container-tasks-infos").style.setProperty('height', height_over, 'important')
        }
        else{
            document.getElementById("container-tasks-buttons").style.setProperty('height', '100%', 'important')
            document.getElementById("container-tasks-infos").style.setProperty('height', '100%', 'important')
        }
    }

</script>

<script>
    let int = null;
    let timerRef = document.querySelector('.timerDisplay');

    document.getElementById('startTimer').addEventListener('click', ()=>{
        if(int!==null){
            clearInterval(int);
        }
        $("#startTimer")[0].style.display = "none";
        $("#pauseTimer")[0].style.display = "block";
        $("#startTimer")[0].accessKey = "";
        $("#pauseTimer")[0].accessKey = " ";
        int = setInterval(displayTimer, 1000);
    });

    document.getElementById('pauseTimer').addEventListener('click', ()=>{
        clearInterval(int);
        $("#pauseTimer")[0].style.display = "none";
        $("#startTimer")[0].style.display = "block";
        $("#pauseTimer")[0].accessKey = "";
        $("#startTimer")[0].accessKey = " ";
        let duration = document.getElementById("duration-task-selected").value;
        try{
            const existingTasks = JSON.parse(localStorage.getItem("tasks"));
            var id_label = document.getElementById("id-task-selected").value;
            existingTasks[id_label]['duration'] = duration;
            localStorage.setItem("tasks", JSON.stringify(existingTasks));
        }
        catch(e){}
    });

    document.getElementById('resetTimer').addEventListener('click', ()=>{
        document.getElementById('pauseTimer').click()
        clearInterval(int);
        document.getElementById("duration-task-selected").value = 0;
        timerRef.innerHTML = '00<span style="color:#3E4559!important">:</span>00<span style="color:#3E4559!important">:</span>00 ';
    });

    function displayTimer(){
        let duration = document.getElementById("duration-task-selected").value;
        let id_label = document.getElementById("id-task-selected").value;

        let hours = Math.floor(duration/3600)
        let minutes = Math.floor((duration%3600)/60)
        let seconds = (duration%3600)%60
        seconds++;
        if(seconds == 60){
            seconds = 0;
            minutes++;
            if(minutes == 60){
                minutes = 0;
                hours++;
            }
        }
        document.getElementById("duration-task-selected").value++

        const existingTasks = JSON.parse(localStorage.getItem("tasks"));
        existingTasks[id_label]['duration'] = duration;
        localStorage.setItem("tasks", JSON.stringify(existingTasks));
        
        let h = hours < 10 ? "0" + hours : hours;
        let m = minutes < 10 ? "0" + minutes : minutes;
        let s = seconds < 10 ? "0" + seconds : seconds;

        timerRef.innerHTML = ` ${h}<span style="color:#3E4559!important">:</span>${m}<span style="color:#3E4559!important">:</span>${s}`;
    }
</script>




